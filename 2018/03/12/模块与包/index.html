<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>模块与包 | 广志大兄弟的个人网站</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="如果你用过 Python，那么你一定用过 import 关键字加载过各式各样的模块。但你是否熟悉 Python 中的模块与包的概念呢？或者，以下几个问题，你是否有明确的答案？  什么是模块？什么又是包？ from matplotlib.ticker import Formatter, FixedLocator 中的 matplotlib 和 ticker 分别是什么？中间的句点是什么意思？ fro">
<meta name="keywords" content="python">
<meta property="og:type" content="article">
<meta property="og:title" content="模块与包">
<meta property="og:url" content="http://yoursite.com/2018/03/12/模块与包/index.html">
<meta property="og:site_name" content="广志大兄弟的个人网站">
<meta property="og:description" content="如果你用过 Python，那么你一定用过 import 关键字加载过各式各样的模块。但你是否熟悉 Python 中的模块与包的概念呢？或者，以下几个问题，你是否有明确的答案？  什么是模块？什么又是包？ from matplotlib.ticker import Formatter, FixedLocator 中的 matplotlib 和 ticker 分别是什么？中间的句点是什么意思？ fro">
<meta property="og:updated_time" content="2018-03-12T04:36:59.163Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="模块与包">
<meta name="twitter:description" content="如果你用过 Python，那么你一定用过 import 关键字加载过各式各样的模块。但你是否熟悉 Python 中的模块与包的概念呢？或者，以下几个问题，你是否有明确的答案？  什么是模块？什么又是包？ from matplotlib.ticker import Formatter, FixedLocator 中的 matplotlib 和 ticker 分别是什么？中间的句点是什么意思？ fro">
  
    <link rel="alternative" href="/atom.xml" title="广志大兄弟的个人网站" type="application/atom+xml">
  
  
    <link rel="icon" href="https://raw.githubusercontent.com/tremblehub/itguangzhi.com/slave1/repo/img/tremblehub.github.io/H%2B.png">
  
  <link rel="stylesheet" href="/css/style.css">
  
  

  <script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>
  <script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>

  
</head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://raw.githubusercontent.com/tremblehub/itguangzhi.com/slave1/repo/img/tremblehub.github.io/%E7%99%BD%E7%A5%9E.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">广志大兄弟</a></h1>
		</hgroup>

		
		<p class="header-subtitle">欲戴王冠，必承其重</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="zhihu" target="_blank" href="https://zhuanlan.zhihu.com/guangzhi" title="zhihu">zhihu</a>
					        
								<a class="mail" target="_blank" href="mailto:itguangzhi@163.com" title="mail">mail</a>
					        
								<a class="qq" target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=3534466071&site=qq&menu=yes" title="qq">qq</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/sqoop2/" style="font-size: 15px;">sqoop2</a> <a href="/tags/themes/" style="font-size: 10px;">themes</a> <a href="/tags/深度学习-电影推荐/" style="font-size: 10px;">深度学习.电影推荐</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">广志大兄弟</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="https://raw.githubusercontent.com/tremblehub/itguangzhi.com/slave1/repo/img/tremblehub.github.io/%E7%99%BD%E7%A5%9E.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">广志大兄弟</h1>
			</hgroup>
			
			<p class="header-subtitle">欲戴王冠，必承其重</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="zhihu" target="_blank" href="https://zhuanlan.zhihu.com/guangzhi" title="zhihu">zhihu</a>
			        
						<a class="mail" target="_blank" href="mailto:itguangzhi@163.com" title="mail">mail</a>
			        
						<a class="qq" target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=3534466071&site=qq&menu=yes" title="qq">qq</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-模块与包" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2018/03/12/模块与包/" class="article-date">
  	<time datetime="2018-03-12T04:27:50.000Z" itemprop="datePublished">2018-03-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      模块与包
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>
	</div>

        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
		
			
			
				<p>如果你用过 Python，那么你一定用过 import 关键字加载过各式各样的模块。但你是否熟悉 Python 中的模块与包的概念呢？或者，以下几个问题，你是否有明确的答案？</p>
<ul>
<li>什么是模块？什么又是包？</li>
<li>from matplotlib.ticker import Formatter, FixedLocator 中的 matplotlib 和 ticker 分别是什么？中间的句点是什么意思？</li>
<li>from matplotlib.pyplot import <em> 中，import </em> 的背后会发生什么？</li>
</ul>
<p>鲁迅先生说：「于无声处听惊雷」，讲的是平淡时却有令人惊奇、意外的事情。import 相关的模块、包的概念也是如此。如果你对上面几个问题存有疑问，那么这篇就是为你而作的。</p>
<h1 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h1><h2 id="为什么要有模块"><a href="#为什么要有模块" class="headerlink" title="为什么要有模块"></a>为什么要有模块</h2><p>众所周知，Python 有一个交互式的解释器。在解释器中，你可以使用 Python 的所有功能。但是，解释器是一次性的。也就是说，如果你关掉解释器，那么先前定义、运行的一切东西，都会丢失不见。另一方面，在解释器中输入代码是一件很麻烦的事情；这是因为在解释器中复用代码比较困难。</p>
<p>为此，人们会把相对稳定、篇幅较长的代码保存在一个纯文本文件中。一般来说，我们把这样扩展名为 .py 的文件称为 Python 脚本。为了提高代码复用率，我们可以把一组相关的 Python 相关的定义、声明保存在同一个 .py 文件中。此时，这个 Python 脚本就是一个 Python 模块（Module）。我们可以在解释器中，或者在其他 Python 脚本中，通过 import 载入定义好的 Python 模块。</p>
<h2 id="模块的识别"><a href="#模块的识别" class="headerlink" title="模块的识别"></a>模块的识别</h2><p>和 Python 中的其它对象一样，Python 也为模块定义了一些形如 <strong>foo</strong> 的变量。对于模块来说，最重要的就是它的名字 <strong>name</strong> 了。每当 Python 执行脚本，它就会为该脚本赋予一个名字。对于「主程序」来说，这一脚本的 <strong>name</strong> 被定义为 “<strong>main</strong>“；对于被 import 进主程序的模块来说，这一脚本的 <strong>name</strong> 被定义为脚本的文件名（base filename）。因此，我们可以用 if <strong>name</strong> == “<strong>main</strong>“: 在模块代码中定义一些测试代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">fibonacci.py</span><br><span class="line">def fib_yield(n):</span><br><span class="line">    a, b = 0, 1</span><br><span class="line">    while b &lt; n:</span><br><span class="line">        yield b</span><br><span class="line">        a, b = b, a+b</span><br><span class="line"></span><br><span class="line">def fib(n):</span><br><span class="line">    for num in fib_yield(n):</span><br><span class="line">        print(num)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    fib(10)</span><br></pre></td></tr></table></figure>
<p>我们将其保存为 fibonacci.py，而后在 Python 解释器中 import 它。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">In [1]: import fibonacci</span><br><span class="line"></span><br><span class="line">In [2]: dir(fibonacci)</span><br><span class="line">Out[2]:</span><br><span class="line">[&apos;__builtins__&apos;,</span><br><span class="line"> &apos;__doc__&apos;,</span><br><span class="line"> &apos;__file__&apos;,</span><br><span class="line"> &apos;__name__&apos;,</span><br><span class="line"> &apos;__package__&apos;,</span><br><span class="line"> &apos;fib&apos;,</span><br><span class="line"> &apos;fib_yield&apos;]</span><br><span class="line"></span><br><span class="line">In [3]: print(fibonacci.__name__)</span><br><span class="line">fibonacci</span><br><span class="line"></span><br><span class="line">In [4]: fibonacci.fib(5)</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line"></span><br><span class="line">In [5]: for num in fibonacci.fib_yield(5):</span><br><span class="line">   ...:     print(num)</span><br><span class="line">   ...:</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<p>可以观察到，fibonacci.py 在作为模块引入时，fibonacci.<strong>name</strong> 被设置为文件名 “fibonacci”。但若在命令行直接执行 python fibonacci.py，则 if 语句块会被执行，此时 <strong>name</strong> 是 “<strong>main</strong>“。</p>
<h2 id="模块的内部变量和初始化"><a href="#模块的内部变量和初始化" class="headerlink" title="模块的内部变量和初始化"></a>模块的内部变量和初始化</h2><p>Python 为每个模块维护了单独的符号表，因此可以实现类似 C++ 中名字空间（namespace）的功能。Python 模块中的函数，可以使用模块的内部变量，完成相关的初始化操作；同时，import 模块的时候，也不用担心这些模块内部变量与用户自定义的变量同名冲突。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">module_var.py</span><br><span class="line">foo = 0</span><br><span class="line"></span><br><span class="line">def show():</span><br><span class="line">    print(foo)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    show()</span><br></pre></td></tr></table></figure>
<p>此处我们在模块 module_var 内部定义了内部变量 foo，并且在函数 show 中引用了它。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">In [7]: import module_var</span><br><span class="line">   ...:</span><br><span class="line">   ...: foo = 3</span><br><span class="line">   ...:</span><br><span class="line">   ...: print(foo)</span><br><span class="line">   ...: print(module_var.foo)</span><br><span class="line">   ...:</span><br><span class="line">   ...: module_var.show()</span><br><span class="line">   ...:</span><br><span class="line">3</span><br><span class="line">0</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<p>值得一提的是，模块的初始化操作（这里指 foo = 0 这条语句），仅只在 Python 解释器第一次处理该模块的时候执行。也就是说，如果同一个模块被多次 import，它只会执行一次初始化。</p>
<h2 id="from-…-import-…"><a href="#from-…-import-…" class="headerlink" title="from … import …"></a>from … import …</h2><p>模块提供了类似名字空间的限制，不过 Python 也允许从模块中导入指定的符号（变量、函数、类等）到当前模块。导入后，这些符号就可以直接使用，而不需要前缀模块名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [8]: from fibonacci import fib_yield, fib</span><br><span class="line"></span><br><span class="line">In [9]: fib(10)</span><br><span class="line">1</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">5</span><br><span class="line">8</span><br></pre></td></tr></table></figure>
<p>值得一提的是，被导入的符号，如果引用了模块内部的变量，那么在导入之后也依然会使用模块内的变量，而不是当前环境中的同名变量。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">In [11]: from module_var import show</span><br><span class="line"></span><br><span class="line">In [12]: foo = 3</span><br><span class="line"></span><br><span class="line">In [13]: show()</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<p>也有更粗暴的方式，导入模块内的所有公开符号（没有前缀 _ 的那些）。不过，一般来说，除了实验、排查，不建议这样做。因为，通常你不知道模块定义了哪些符号、是否与当前环境有重名的符号。一旦有重名，那么，这样粗暴地导入模块内所有符号，就会覆盖掉当前环境的版本。从而造成难以排查的错误。</p>
<h2 id="模块搜索路径"><a href="#模块搜索路径" class="headerlink" title="模块搜索路径"></a>模块搜索路径</h2><p>之前我们都在讨论模块的好处，但是忽略了一个问题：Python 怎样知道从何处找到模块文件？</p>
<p>如果你熟悉命令行，那么这个问题对你来说就不难理解。在命令行中执行的任何命令，实际上背后都对应了一个可执行文件。命令行解释器（比如 cmd, bash）会从一个全局的环境变量 PATH 中读取一个有序的列表。这个列表包含了一系列的路径，而命令行解释器，会依次在这些路径里，搜索需要的可执行文件。</p>
<p>Python 搜寻模块文件，也遵循了类似的思路。比如，用户在 Python 中尝试导入 import foobar，那么</p>
<ul>
<li>首先，Python 会在内建模块中搜寻 foobar；</li>
<li>若未找到，则 Python 会在当前工作路径（当前脚本所在路径，或者执行 Python 解释器的路径）中搜寻 foobar；</li>
<li>若仍未找到，则 Python 会在环境变量 PYTHONPATH 中指示的路径中搜寻 foobar；</li>
<li>若依旧未能找到，则 Python 会在安装时指定的路径中搜寻 foobar；</li>
<li>若仍旧失败，则 Python 会报错，提示找不到 foobar 这个模块。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">In [14]: import foobar</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ImportError                               Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input-14-909badd622c0&gt; in &lt;module&gt;()</span><br><span class="line">----&gt; 1 import foobar</span><br><span class="line"></span><br><span class="line">ImportError: No module named foobar</span><br></pre></td></tr></table></figure>
<h2 id="pyc-文件"><a href="#pyc-文件" class="headerlink" title="pyc 文件"></a>pyc 文件</h2><p>和 LaTeX 中遇到的问题一样：装载大量文本文件是很慢的。因此 Python 也采用了类似 LaTeX 的解决方案：将模块编译成容易装载的文件，并保存起来（相当于 LaTeX 中的 dump 格式文件 .fmt）。这些编译好并保存起来的文件，有后缀名 .pyc。</p>
<p>当 Python 编译好模块之后，下次载入时，Python 就会读取相应的 .pyc 文件，而不是 .py 文件。而装载 .pyc 文件会比装载 .py 文件更快。</p>
<p>值得一提的是，对于 .pyc，很多人一直有误解。事实上，从运行的角度，装载 .pyc 并不比装载 .py 文件更快。此处的加速，仅只在装载模块的过程中起作用。因此 .pyc 中的 C 更多地可以理解为 cache。</p>
<h1 id="包"><a href="#包" class="headerlink" title="包"></a>包</h1><p>包（package）是 Python 中对模块的更高一级的抽象。简单来说，Python 允许用户把目录当成模块看待。这样一来，目录中的不同模块文件，就变成了「包」里面的子模块。此外，包目录下还可以有子目录，这些子目录也可以是 Python 包。这种分层，对模块识别、管理，都是非常有好处的。特别地，对于一些大型 Python 工具包，内里可能有成百上千个不同功能的模块。若是逐个模块发布，那简直成了灾难。</p>
<p>科学计算领域，SciPy, NumPy, Matplotlib 等第三方工具，都是用包的形式发布的。</p>
<h1 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h1><p>Python 要求每一个「包」目录下，都必须有一个名为 <strong>init</strong>.py 的文件。从这个文件的名字上看，首先它有 __ 作为前后缀，我们就知道，这个文件肯定是 Python 内部用来做某种识别用的；其次，它有 init，我们知道它一定和初始化有关；最后，它有 .py 作为后缀名，因此它也是一个 Python 模块，可以完成一些特定的工作。</p>
<p>现在假设你想编写一个 Python 工具包，用来处理图片，它可能由多个 Python 模块组成。于是你会考虑把它做成一个 Python 包，内部按照功能分成若干子包，再继续往下分成不同模块去实现。比如会有这样的目录结构。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">picture/                        Top-level package</span><br><span class="line">      __init__.py               Initialize the picture package</span><br><span class="line">      formats/                  Subpackage for file format conversions</span><br><span class="line">              __init__.py</span><br><span class="line">              jpgread.py</span><br><span class="line">              jpgwrite.py</span><br><span class="line">              pngread.py</span><br><span class="line">              pngwrite.py</span><br><span class="line">              bmpread.py</span><br><span class="line">              bmpwrite.py</span><br><span class="line">              ...</span><br><span class="line">      filters/                  Subpackage for filters</span><br><span class="line">              __init__.py</span><br><span class="line">              boxblur.py</span><br><span class="line">              gaussblur.py</span><br><span class="line">              sharpen.py</span><br><span class="line">              ...</span><br></pre></td></tr></table></figure>
<p>此处 picture 目录下有 <strong>init</strong>.py，因此 Python 会将其作为一个 Python 包；类似地，子目录 formats 和 filters 就成了 picture 下的子包。这里，子包的划分以功能为准。formats 下的模块，设计用于处理不同格式的图片文件的读写；而 filters 下的模块，则被设计用于实现各种滤镜效果。</p>
<h1 id="使用-Python-包"><a href="#使用-Python-包" class="headerlink" title="使用 Python 包"></a>使用 Python 包</h1><p>Python 包的使用和模块的使用类似，是很自然的方式。以我们的 picture 包为例，若你想使用其中具体的模块，可以这样做。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import picutre.filters.gaussblur</span><br></pre></td></tr></table></figure>
<p>如此，你就导入了 picture 包中 filters 子包中的 gaussblur 模块，你就能使用高斯模糊模块提供的功能了。具体使用方式，和使用模块也保持一致。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">picture.filters.gaussblur.gaussblur_filter(input, output)</span><br></pre></td></tr></table></figure>
<p>这看起来很繁琐，因此你可能会喜欢用 from … import … 语句，脱去过多的名字限制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from picture.filters import gaussblur</span><br></pre></td></tr></table></figure>
<p>这样一来，你就可以直接按如下方式使用高斯模糊这一滤镜了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gaussblur.gaussblur_filter(input, output)</span><br></pre></td></tr></table></figure>
<h1 id="init-py"><a href="#init-py" class="headerlink" title="init.py"></a><strong>init</strong>.py</h1><p>之前简单地介绍了 <strong>init</strong>.py 这个特殊的文件，但未展开。这里我们展开详说。</p>
<p>首先的问题是，为什么要设计 <strong>init</strong>.py，而不是自动地把任何一个目录都当成是 Python 包？这主要是为了防止重名造成的问题。比如，很可能用户在目录下新建了一个子目录，名为 collections；但 Python 有内建的同名模块。若不加任何限制地，将子目录当做是 Python 包，那么，import collections 就会引入这个 Python 包。而这样的行为，可能不是用户预期的。从这个意义上说，设计 <strong>init</strong>.py 是一种保护措施。</p>
<p>接下来的问题是，<strong>init</strong>.py 具体还有什么用？</p>
<p>首先来说，<strong>init</strong>.py 可以执行一些初始化的操作。这是因为，<strong>init</strong>.py 作为模块文件，会在相应的 Python 包被引入时首先引入。这就是说，import picture 相当于是 import picture.<strong>init</strong>。因此，<strong>init</strong>.py 中可以保留一些初始化的代码——比如引入依赖的其他 Python 模块。</p>
<p>其次，细心的你可能发现，上一小节中，我们没有介绍对 Python 包的 from picture import <em> 的用法。这是因为，从一个包中导入所有内容，这一行为是不明确的；必须要由包的作者指定。我们可以在 <strong>init</strong>.py 中定义名为 <strong>all</strong> 的 Python 列表。这样一来，就能使用 from picture import </em> 了。</p>
<p>具体来说，我们可以在 picture/<strong>init</strong>.py 中做如下定义。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__init__.py</span><br><span class="line">import collections          # import the built-in package</span><br><span class="line">__all__ = [&quot;formats&quot;, &quot;filters&quot;]</span><br></pre></td></tr></table></figure>
<p>此时，若我们在用户模块中 from picture import *，则首先会引入 Python 内建的 collections 模块，而后引入 picture.formats 和 picture.filters 这两个 Python 子包了。</p>
<h2 id="在包内使用相对层级引用其他模块"><a href="#在包内使用相对层级引用其他模块" class="headerlink" title="在包内使用相对层级引用其他模块"></a>在包内使用相对层级引用其他模块</h2><p>细心的你应该已经发现，在引入 Python 包中的模块时，我们用句点 . 代替了斜线（或者反斜线）来标记路径的层级（实际上是包和模块的层级）。在 Python 包的内部，我们也可以使用类似相对路径的方式，使用相对层级来简化包内模块的互相引用。</p>
<p>比如，在 gaussblur.py 中，你可以通过以下四种方式，引入 boxblur.py，而它们的效果是一样的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import boxblur</span><br><span class="line">from . import boxblur</span><br><span class="line">from ..filters import boxblur</span><br><span class="line">from .. import filters.boxblur as boxblur</span><br></pre></td></tr></table></figure>
<p><a href="https://liam0205.me/2017/07/23/modules-and-packages-of-python/" target="_blank" rel="noopener">原文出处</a></p>

			
		
	</div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2018/03/12/生成器协程的调度问题/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">生成器协程的调度问题</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="ds-share share" data-thread-key="模块与包" data-title="模块与包" data-url="http://yoursite.com/2018/03/12/模块与包/"  data-images="https://raw.githubusercontent.com/tremblehub/itguangzhi.com/slave1/repo/img/tremblehub.github.io/%E7%99%BD%E7%A5%9E.png" data-content="模块与包">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">
	  <!--
      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
		-->
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
 </div>
 





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2018 广志大兄弟
      </div>
        <div class="footer-right">
		心中有远方，必能远方
       <!-- <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a> -->  
        </div>
    </div>
  </div>
</footer>
    </div>
    

<script>
	var yiliaConfig = {
		fancybox: false,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="/js/main.js"></script>



  </div>
</body>
</html>